<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ğŸ° ë‚­ - í† ë¼ ìˆ™ì œ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>

<!-- Firebase App & Firestore -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

<style>
    body {
        font-family: 'Pretendard', sans-serif;
        background: linear-gradient(180deg, #ffe0f0 0%, #fff5fb 100%);
        padding: 20px;
        margin: 0;
    }

    .header {
        text-align: center;
        margin-bottom: 22px;
    }

    .title {
        font-size: 24px;
        font-weight: 700;
        color: #ff6fa8;
    }

    .tag {
        display: inline-block;
        margin-top: 6px;
        padding: 4px 10px;
        border-radius: 999px;
        background: #ffb3d4;
        color: #fff;
        font-size: 13px;
    }

    .item {
        background: #ffffff;
        margin-bottom: 14px;
        padding: 14px 16px;
        border-radius: 18px;
        display: flex;
        align-items: center;
        box-shadow: 0 3px 12px rgba(255, 140, 170, 0.25);
    }

    input[type="checkbox"] {
        width: 24px;
        height: 24px;
        margin-right: 14px;
        accent-color: #ff86b8;
    }

    .text {
        font-size: 17px;
        color: #444;
    }

    input[type="checkbox"]:checked + .text::after {
        content: " ğŸ°ğŸ’—";
        margin-left: 4px;
        animation: pop 0.35s ease-out;
    }

    @keyframes pop {
        0% { transform: scale(0.2); opacity: 0; }
        80% { transform: scale(1.2); opacity: 1; }
        100% { transform: scale(1); opacity: 1; }
    }

    .section-title {
        margin-top: 24px;
        margin-bottom: 6px;
        font-size: 15px;
        font-weight: 600;
        color: #ff6fa8;
    }

    textarea {
        width: 100%;
        min-height: 90px;
        border-radius: 14px;
        border: 1px solid #ffc1dc;
        padding: 10px 12px;
        resize: vertical;
        font-size: 14px;
        font-family: inherit;
        box-sizing: border-box;
        background: #fff;
    }

    .save-btn {
        margin-top: 8px;
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 999px;
        background: #ff6fa8;
        color: #fff;
        font-weight: 600;
        font-size: 15px;
    }

    .admin-memo-view {
        background: #fff7fb;
        border-radius: 14px;
        padding: 10px 12px;
        font-size: 14px;
        color: #555;
        border: 1px dashed #ffb3d4;
        white-space: pre-wrap;
        min-height: 60px;
        box-sizing: border-box;
    }

    .small {
        font-size: 12px;
        color: #999;
        margin-top: 4px;
    }
</style>
</head>

<body>

<div class="header">
    <div class="title">ğŸ° ë‚­ - ì˜¤ëŠ˜ì˜ í† ë¼ ìˆ™ì œ</div>
    <div class="tag">ì‚¬ìš©ì ID: ë‚­ (í•‘í¬)</div>
</div>

<div id="list"></div>

<div class="section-title">âœ ë‚­ì˜ ë©”ëª¨</div>
<textarea id="userMemo" placeholder="ì˜¤ëŠ˜ ìˆ™ì œí•˜ë©´ì„œ ëŠë‚€ ì ì„ ì ì–´ì¤˜ìš” ğŸ°"></textarea>
<button class="save-btn" onclick="saveUserMemo()">ë©”ëª¨ ì €ì¥í•˜ê¸°</button>

<div class="section-title" style="margin-top: 20px;">ğŸ“¢ ë‹¹(ê´€ë¦¬ì)ì˜ ë©”ëª¨</div>
<div id="adminMemoView" class="admin-memo-view">(ì•„ì§ ê´€ë¦¬ìê°€ ë©”ëª¨ë¥¼ ë‚¨ê¸°ì§€ ì•Šì•˜ì–´ìš”)</div>
<div class="small">â€» ì´ ì˜ì—­ì€ ì½ê¸° ì „ìš©ì…ë‹ˆë‹¤.</div>

<script>
  // Firebase ì„¤ì •
  const firebaseConfig = {
    apiKey: "AIzaSyAHmLNi5VOuAE-gXnAg-fEfzylPZvzvfVo",
    authDomain: "daily-checklist-91e5a.firebaseapp.com",
    projectId: "daily-checklist-91e5a",
    storageBucket: "daily-checklist-91e5a.firebasestorage.app",
    messagingSenderId: "66394691958",
    appId: "1:66394691958:web:cf91f295456a2e10d18257",
    measurementId: "G-87WK4N4EGH"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const docRef = db.collection("checklist").doc("ë‚­");

  // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
  docRef.onSnapshot((doc) => {
      if (!doc.exists) {
          docRef.set({ items: [], userMemo: "", adminMemo: "" });
          return;
      }

      const data = doc.data();
      renderItems(data.items || []);
      renderMemo(data.userMemo, data.adminMemo);
  });

  function renderItems(items) {
      const box = document.getElementById("list");
      box.innerHTML = "";

      items.forEach((item, index) => {
          const div = document.createElement("div");
          div.className = "item";

          div.innerHTML = `
              <input type="checkbox" ${item.done ? "checked" : ""} onclick="toggleItem(${index})">
              <span class="text">${item.text}</span>
          `;

          box.appendChild(div);
      });
  }

  function toggleItem(index) {
      docRef.get().then((doc) => {
          const d = doc.data();
          d.items[index].done = !d.items[index].done;
          docRef.update({ items: d.items });
      });
  }

  function renderMemo(userMemo, adminMemo) {
      document.getElementById("userMemo").value = userMemo || "";
      document.getElementById("adminMemoView").textContent =
        adminMemo || "(ì•„ì§ ê´€ë¦¬ìê°€ ë©”ëª¨ë¥¼ ë‚¨ê¸°ì§€ ì•Šì•˜ì–´ìš”)";
  }

  function saveUserMemo() {
      const memo = document.getElementById("userMemo").value;
      docRef.update({ userMemo: memo });
      alert("ë‚­ì˜ ë©”ëª¨ê°€ ì €ì¥ëì–´ìš” ğŸ°");
  }
</script>

</body>
</html>
